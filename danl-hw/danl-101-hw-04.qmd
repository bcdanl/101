---
title: Homework Assignment 4
subtitle: ""
date: last-modified
from: markdown+emoji
comments: false
code-fold: false

execute: 
  warning: false
  message: false
  fig-width: 9
  fig-height: 7
  fig-align: center
  eval: false
---


```{r}
#| include: false
#| eval: true

library(tidyverse)
library(skimr)
library(DT)
library(hrbrthemes)
library(ggthemes)
library(gapminder)

titanic <- read_csv("https://bcdanl.github.io/data/titanic_cleaned.csv")
oj <- read_csv("https://bcdanl.github.io/data/dominick_oj_na.csv")
mlb_bat <- read_csv("https://bcdanl.github.io/data/MLB_batting.csv")

theme_set(theme_ipsum() +
          theme(strip.background =element_rect(fill="lightgray"),
                axis.title.x = element_text(size = rel(1.5)),
                axis.title.y = element_text(size = rel(1.5), angle = 0),
                legend.title = element_text(size=rel(1.25))
                ))

# Set global options for color-blind-friendly scales
scale_colour_discrete <- function(...) scale_color_tableau(...)
scale_fill_discrete <- function(...) scale_fill_tableau(...)

```


- Please answer all of the following questions thoroughly, ensuring that none are left unanswered.
- For Homework Assignment 4, the use of any generative artificial intelligence (AI) tools is strictly prohibited.
- **Craft your answers in a separate document (such as an R script, Word file, or Google Doc) and paste them into this page when you are ready to submit.**
- Once you have completed the assignment, click the "Submit" button at the bottom of this page to have it evaluated.
  - After clicking **"Submit"** button, wait for the message, **"Data submitted successfully!"**.
  - A **confirmation email** will be sent to the email address that you provide on this homework page once your submission is received.
- You may submit multiple times, but only your most recent submission will be evaluated.
- The due is <u>November 16, 5:00 P.M., 2024, Saturday, Eastern Time</u>.

<br>

<form id="form" class="container m-2 pl-2" action="submit.php" method="POST">

# Student Information

What is your DANL 101 session schedule?
```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="session" value="MWF 9:30am-10:20am" /> MWF 9:30am-10:20am
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="session" value="TTh 3:30pm-4:45pm" /> TTh 3:30pm-4:45pm
  </label>
</div>

```

<br>

What is your first name?

```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="first-name"
    rows="2"
    style="width: 50%;"
  ></textarea>
</div>
```

<br>

What is your last name?

```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="last-name"
    rows="2"
    style="width: 50%;"
  ></textarea>
</div>
```

<br>

Please enter your Geneseo email address without @geneseo.edu. For example, if your full Geneseo email address is abcd234@geneseo.edu, you should enter only abcd234. If you do not have a Geneseo email, please provide your full email address (e.g., abcd@gmail.com).


```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="email"
    rows="2"
    style="width: 50%;"
  ></textarea>
</div>
```

<br>

What is your GitHub username?

```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="github"
    rows="2"
    style="width: 50%;"
  ></textarea>
</div>
```

<br>

How many times have you submitted this assignment so far?

```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="nth"
    rows="2"
    style="width: 50%;"
  ></textarea>
</div>
```

<br>



# Multiple Choice Questions

## Question 1
Which of the following is a core technology behind language models like ChatGPT, as mentioned in the lecture?

```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q1" value="a" /> Decision Trees
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q1" value="b" /> Deep Learning
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q1" value="c" /> Linear Regression
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q1" value="d" /> All of the Above
  </label>
</div>

```

<br>

## Question 2
What is the primary purpose of storyboarding in data storytelling?

```{=html}

<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q2" value="a" /> To collect data from stakeholders
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q2" value="b" /> To provide a visual outline for content structure
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q2" value="c" /> To design complex data visualizations
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q2" value="d" /> To perform statistical analysis
  </label>
</div>

```

<br>

## Question 3
Which of the following statements about data visualizations is true?

```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q3" value="a" /> They always explain the underlying reasons behind data trends.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q3" value="b" /> They are sufficient on their own to drive data-informed decisions.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q3" value="c" /> They are useful for showing “what” is happening in the data.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q3" value="d" /> They eliminate the need for narratives in data storytelling.
  </label>
</div>

```

<br>

## Question 4
In the ggplot2 syntax `ggplot(data, aes(x, y)) + geom_point()`, what does `aes()` stand for?

```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q4" value="a" /> Aesthetic mappings
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q4" value="b" /> Arithmetic expressions
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q4" value="c" /> Axis equal scaling
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q4" value="d" /> Average error squares
  </label>
</div>

```


<br>

## Question 5
The equation $\Delta\log(x) \approx \Delta x / x_{0}$ demonstrates that a small change in the natural logarithm of $x$, starting from an initial value $x_0$, approximates:


```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q5" value="a" /> The absolute change in <span class="math inline">\(x\)</span>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q5" value="b" /> The percentage change in <span class="math inline">\(x\)</span>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q5" value="c" /> The square of <span class="math inline">\(x\)</span>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q5" value="d" /> The reciprocal of <span class="math inline">\(x\)</span>
  </label>
</div>

```




<br>

## Question 6
Which of the following statements about mapping and setting aesthetics in `ggplot2` is FALSE?



```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q6" value="a" /> Mapping aesthetics involves linking data variables to visual properties within <code>aes()</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q6" value="b" /> Setting aesthetics manually is done outside of <code>aes()</code> to set fixed visual properties.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q6" value="c" /> You can set aesthetics manually within <code>aes()</code> by assigning fixed values.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q6" value="d" /> Mapping aesthetics allows different categories to be represented by different colors or shapes.
  </label>
</div>

```



<br>

## Question 7
Which of the following is NOT a way to explicitly inform ggplot about the grouping structure in a line plot?


```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q7" value="a" /> Using the <code>group</code> aesthetic.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q7" value="b" /> Using the <code>color</code> aesthetic.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q7" value="c" /> Using the <code>linetype</code> aesthetic.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q7" value="d" /> Using the <code>size</code> aesthetic.
  </label>
</div>

```



<br>

## Question 8
If you have a data frame with a date variable and want to plot a time series for each category in a variable called `group_var`, what is the minimal aesthetic mapping required in `ggplot2` to correctly plot separate lines for each group?


```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q8" value="a" /> <code>mapping = aes(x = date_var, y = value_var)</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q8" value="b" /> <code>mapping = aes(x = date_var, y = value_var, color = group_var)</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q8" value="c" /> <code>mapping = aes(x = date_var, y = value_var, group = group_var)</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q8" value="d" /> Both <code>mapping = aes(x = date_var, y = value_var, color = group_var)</code> and <code>mapping = aes(x = date_var, y = value_var, group = group_var)</code>
  </label>
</div>

```




<br>

## Question 9
When creating a vertical boxplot in `ggplot2`, which of the following mappings is correct?


```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q9" value="a" /> Map both the <code>x</code> and <code>y</code> aesthetics to categorical variables.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q9" value="b" /> Map a numeric variable to <code>x</code> and a categorical variable to <code>y</code>.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q9" value="c" /> Map a categorical variable to <code>x</code> and a numeric variable to <code>y</code>.
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q9" value="d" /> Map both the <code>x</code> and <code>y</code> aesthetics to numeric variables.
  </label>
</div>

```


<br>

## Question 10
Which of the following functions is used to apply a color-blind friendly palette to the `fill` aesthetic in `ggplot2`?


```{=html}
<div class="control">
  <label class="radio" style="display: block;">
    <input type="radio" name="q10" value="a" /> <code>scale_fill_manual()</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q10" value="b" /> <code>scale_fill_tableau()</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q10" value="c" /> <code>scale_color_gradient()</code>
  </label>
  <label class="radio" style="display: block;">
    <input type="radio" name="q10" value="d" /> <code>scale_x_continuous()</code>
  </label>
</div>

```


# Data Visualization with `ggplot`
The followings are the R packages for this homework assignment:

```{r}
library(tidyverse)
library(skimr)
library(ggthemes)
library(gapminder)
```


## Questions 11-17
Consider the following `titanic` data.frame for Questions 11-17:

```{r}
titanic <- read_csv("https://bcdanl.github.io/data/titanic_cleaned.csv")
```

```{r}
#| echo: false
#| eval: true
rmarkdown::paged_table(titanic)
```

<br>

### Question 11

How would you create the following data.frame, `titanic_class_survival`?

```{r}
#| echo: false
#| eval: true
#| results: asis

titanic_class_survival <- titanic |> count(class, survived)
rmarkdown::paged_table(titanic_class_survival)
```

- The `titanic_class_survival` data.frame counts the number of passengers who survived and those who did not survive within each `class` in the `titanic` data.frame.

Complete the code by filling in the blanks.

```{r}
__BLANK 1__ <- titanic |> 
  count(__BLANK 2__)

```


```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q11-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q11-2"
      rows="2"
      style="width: 100%;"
    ></textarea>
  </div>
</div>
```

<br>

### Question 12
How would you describe the variation in the distribution of `age` across `classes` and `genders`?

Complete the code by filling in the blanks.
```{r}
ggplot(data = __BLANK 1__,
       mapping = aes(x = gender,
                     __BLANK 2__ = age,
                     __BLANK 3__ = gender)) +
  __BLANK 4__(show.legend = F) +
  __BLANK 5__(~class) +
  scale_fill_tableau()
```


```{r}
#| echo: false
#| eval: true
#| fig-align: center
#| fig-width: 9
titanic |> 
  ggplot(aes(y = age,
             x = gender,
             fill = gender)) +
  geom_boxplot(show.legend = F) +
  facet_wrap(~class)
```

```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q12-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q12-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q12-3"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q12-4"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q12-5"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>
</div>
```


<br>

### Question 13
Provide a comment on the variation in the distribution of `age` across `classes` and `genders`.

```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="q13"
    rows="4"
    style="width: 100%;"
  ></textarea>
</div>
```

<br>

### Question 14
How would you describe the variation in the distribution of `survived` across `classes` and `genders`?

Complete the code by filling in the blanks.
```{r}
ggplot(data = __BLANK 1__,
       mapping = aes(__BLANK 2__ = class,
                     __BLANK 3__ = survived)) +
  __BLANK 4__() +
  __BLANK 5__(~gender) +
  labs(x = "Proportion") +
  scale_fill_tableau()
```


```{r}
#| echo: false
#| eval: true
#| fig-align: center
#| fig-width: 9

ggplot(titanic,
       aes(y = class,
           fill = survived)) +
  geom_bar() +
  facet_wrap(~gender)
```

```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q14-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q14-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q14-3"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q14-4"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q14-5"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>
</div>
```


<br>


### Question 15
How would you describe the variation in the distribution of `survived` across `classes` and `genders`?

Complete the code by filling in the blanks.
```{r}
ggplot(data = __BLANK 1__,
       mapping = aes(__BLANK 2__ = class,
                     __BLANK 3__ = survived)) +
  __BLANK 4__(position = __BLANK 5__) +
  __BLANK 6__(~gender) +
  labs(x = "Proportion") +
  scale_fill_tableau()
```


```{r}
#| echo: false
#| eval: true
#| fig-align: center
#| fig-width: 9

ggplot(titanic,
       aes(y = class,
           fill = survived)) +
  geom_bar(position = "fill") +
  facet_wrap(~gender) +
  labs(x = "Proportion")
```

```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q15-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q15-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q15-3"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q15-4"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q15-5"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q15-6"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>
</div>
```


<br>


### Question 16
How would you describe the variation in the distribution of `survived` across `classes` and `genders`?

Complete the code by filling in the blanks.
```{r}
ggplot(data = __BLANK 1__,
       mapping = aes(__BLANK 2__ = class,
                     __BLANK 3__ = survived)) +
  __BLANK 4__(position = __BLANK 5__) +
  __BLANK 6__(~gender) +
  scale_fill_tableau()
```


```{r}
#| echo: false
#| eval: true
#| fig-align: center
#| fig-width: 9

ggplot(titanic,
       aes(y = class,
           fill = survived)) +
  geom_bar(position = "dodge") +
  facet_wrap(~gender) 
```

```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q16-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q16-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q16-3"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q16-4"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q16-5"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q16-6"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>
</div>
```


<br>


### Question 17
Provide a comment on the variation in the distribution of `survived` across `classes` and `genders`.

```{=html}
<div class="control">
  <textarea
    class="textarea"
    placeholder="Provide your answer here"
    name="q17"
    rows="5"
    style="width: 100%;"
  ></textarea>
</div>
```

<br>

## Questions 18-20
Consider the following `nyc_dogs` data.frame for Questions 18-20:

```{r}
#| eval: true
nyc_dogs <- read_csv("https://bcdanl.github.io/data/nyc_dogs_cleaned.csv")
```

```{r}
#| echo: false
#| eval: true
rmarkdown::paged_table(nyc_dogs)
```

- The `nyc_dogs` data.frame contains data on licensed dogs in New York city.



<br>

### Question 18

How would you create the following data.frame, `nyc_dogs_breeds`?

```{r}
#| echo: false
#| eval: true
#| results: asis

nyc_dogs_breeds <- nyc_dogs |> 
  count(breed) |> 
  filter(!is.na(breed)) |> 
  filter(n >= 2000) |> 
  arrange(-n)
rmarkdown::paged_table(nyc_dogs_breeds)
```

- The `nyc_dogs_breeds` data.frame counts the number of occurrences for each value in the `breed` variable in the `nyc_dogs` data.frame.
  - The `nyc_dogs_breeds` data.frame keeps observations if 
    1. The number of occurrences (`n`) is greater than or equal to 2000;
    2. The value of `breed` is not missing.
  - The observations in the `nyc_dogs_breeds` data.frame is arranged by `n` in descending order.


Complete the code by filling in the blanks.

```{r}

__BLANK 1__ <- nyc_dogs |> 
  __BLANK 2__ |> 
  filter(__BLANK 3__(breed)) |> 
  filter(__BLANK 4__) |> 
  arrange(__BLANK 5__)

```


```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q18-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q18-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q18-3"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q18-4"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 5"
      name="q18-5"
      rows="2"
      style="width: 100%;"
    ></textarea>
  </div>
</div>
```

<br>

### Question 19
How would you describe the distribution of `breed` using the `nyc_dogs_breeds` data.frame?

Complete the code by filling in the blanks.
```{r}
ggplot(data = __BLANK 1__,
       mapping = aes(x = __BLANK 1__,
                     __BLANK 3__)) +
  __BLANK 4__()
```


```{r}
#| echo: false
#| eval: true
#| fig-align: center
#| fig-width: 9
#| fig-height: 15
ggplot(data = nyc_dogs_breeds,
       mapping = aes(x = n,
                     y = breed)) +
  geom_col()
```

```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q19-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q19-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q19-3"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q19-4"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>
</div>
```


<br>

### Question 20
How would you describe the distribution of `breed` using the `nyc_dogs_breeds` data.frame?

Complete the code by filling in the blanks.
```{r}
ggplot(data = __BLANK 1__,
       mapping = aes(x = __BLANK 1__,
                     __BLANK 3__)) +
  __BLANK 4__() +
  labs(y = "Breed")
```


```{r}
#| echo: false
#| eval: true
#| fig-align: center
#| fig-width: 9
#| fig-height: 15
ggplot(data = nyc_dogs_breeds,
       mapping = aes(x = n,
                     y = fct_reorder(breed, n))) +
  geom_col() +
  labs(y = "Breed")
```

```{=html}
<div class="control" style="display: flex; flex-wrap: wrap; gap: 10px;">
  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 1"
      name="q20-1"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 2"
      name="q20-2"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>

  <div style="flex: 1; min-width: 200px;">
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 3"
      name="q20-3"
      rows="2"
      style="width: 100%;"
    ></textarea>
    <textarea
      class="textarea"
      placeholder="Provide your answer for BLANK 4"
      name="q20-4"
      rows="2"
      style="width: 100%; margin-top: 10px;"
    ></textarea>
  </div>
</div>
```

<br>


```{=html}
<div class="field is-grouped" style="display: flex; align-items: center;">
  <div class="control" style="margin-right: 10px;">
    <button class="button is-primary" type="submit" id="submit-button" style="font-size: 1.25em; padding: 8px 16px;">
      Submit
    </button>
  </div>
  <div class="control">
    <button class="button is-danger" style="font-size: 1.25em; padding: 8px 16px;">
      Cancel
    </button>
  </div>
</div>

<style>
  .button.is-primary {
    background-color: #00d1b2;
    border-color: transparent;
    color: #fff;
  }
  .button.is-danger {
    background-color: #f14668;
    border-color: transparent;
    color: #fff;
  }
</style>

<div
  id="message"
  style="
    display: none;
    margin: 18px;
    font-weight: bold;
    color: green;
    padding: 8px;
    background-color: beige;
    border-radius: 4px;
    border-color: aquamarine;
  "
></div>
```

</form>

<script>
    const form = document.getElementById('form');
    const messageElement = document.getElementById('message');
    const submitButton = document.getElementById('submit-button');

    form.addEventListener("submit", function (e) {
        e.preventDefault(); // Prevent the default form submission
        messageElement.textContent = "Submitting..";
        messageElement.style.display = "block";
        submitButton.disabled = true;

        // Collect the form data
        var formData = new FormData(this);
        var keyValuePairs = [];
        for (var pair of formData.entries()) {
            keyValuePairs.push(pair[0] + "=" + encodeURIComponent(pair[1]));
        }

        var formDataString = keyValuePairs.join("&");

        // Send a POST request to your Google Apps Script
        fetch(
            "https://script.google.com/macros/s/AKfycbz-qfjasNy9Jmgqg8u4mPySsmkZ7RgJsAO5DVZYVm5P8T8Qif3bhjNgXpFz-03PDwA/exec",
            {
                redirect: "follow",
                method: "POST",
                body: formDataString,
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded;charset=UTF-8",
                },
            }
        )
        .then(function (response) {
            // Check if the request was successful
            if (response.ok) {
                return response.json(); // Assuming your script returns JSON response
            } else {
                throw new Error("Failed to submit the form.");
            }
        })
        .then(function (data) {
            // Display a success message
            messageElement.textContent = "Data submitted successfully!";
            messageElement.style.display = "block";
            messageElement.style.backgroundColor = "green";
            messageElement.style.color = "beige";
            submitButton.disabled = false;
            form.reset();

            setTimeout(function () {
                messageElement.textContent = "";
                messageElement.style.display = "none";
            }, 2600);
        })
        .catch(function (error) {
            // Handle errors, display an error message
            console.error(error);
            messageElement.textContent = "An error occurred while submitting the form.";
            messageElement.style.display = "block";
            messageElement.style.backgroundColor = "red";
            messageElement.style.color = "white";
            submitButton.disabled = false;
        });
    });
</script>
<!-- ```{=html} -->
<!-- <iframe id="contentFrame" width="100%" height="12000px" frameborder="no" -->
<!--   src="danl-101-hw-04-google-sheet.html" style="overflow: hidden;"> -->
<!-- </iframe> -->
<!-- ``` -->




