---
title: Lecture 9
subtitle: Data Visualization
format:
  clean-revealjs:
    self-contained: false
    chalkboard: true
    incremental: true
    code-annotations: hover
    scrollable: false

    # logo: logo-title-slide.png
author:
  - name: Byeong-Hak Choe
    email: bchoe@geneseo.edu
    affiliations: SUNY Geneseo
date: 2025-11-03
execute: 
  eval: true
  echo: false
callout-icon: false

from: markdown+emoji
include-after-body: target-hover.html # effect.html

# bibliography: refs.bib
---

```{r setup}
#| include: false

library(tidyverse)
library(lubridate)
library(skimr)
library(ggthemes)
library(hrbrthemes)
library(viridis)
library(rmarkdown)
library(gapminder)
library(ggrepel)


titanic <- read_csv("https://bcdanl.github.io/data/titanic_cleaned.csv")
oj <- read_csv("https://bcdanl.github.io/data/dominick_oj_feat.csv")
nvda <- read_csv("https://bcdanl.github.io/data/nvda_2015_2025.csv") |> 
  mutate(Date = as.Date(Date))
nbc <- read_csv("https://bcdanl.github.io/data/nbc_show.csv")
weather_indep <- read_csv("https://bcdanl.github.io/data/Completely_Independent_Variables__Rainfall_and_Temperature.csv")

theme_set(theme_fivethirtyeight() +
            theme(strip.background =element_rect(fill="lightgray"),
                axis.title.x = 
                  element_text(angle = 0,
                               size = rel(1.75),
                               margin = margin(10,0,0,0)),
                axis.title.y = 
                  element_text(angle = 0,
                               size = rel(1.75),
                               margin = margin(0,10,0,0)),
                axis.text.x = element_text(size = rel(1.75)),
                axis.text.y = element_text(size = rel(1.75)),
                strip.text = element_text(size = rel(1.5)),
                legend.position = "top",
                legend.text = element_text(size = rel(1.5)),
                legend.title = element_text(size = rel(1.5))
                )
          )


# Set global options for color-blind-friendly scales
scale_colour_discrete <- function(...) scale_colour_viridis_d(...)
scale_fill_discrete <- function(...) scale_fill_viridis_d(...)
```





# **Data Visualization** {background-color="#1c4982"}


## Data Storytelling

:::: {.columns}

::: {.column width="55%"}
<div style="text-align: center; width: 100%; margin: auto;">
  <img src="https://bcdanl.github.io/lec_figs/data-storytelling.png" style="width: 60%; margin-bottom: -20px;">
  <p style="font-weight: bold;"></p>
</div>
:::
::: {.column width="10%"}

<div style="display:block; margin:120px;"></div>

<div style="text-align:center; font-size:2.5rem; font-weight:bold;">
‚Üí 
</div>



:::
::: {.column width="35%"}

<div style="display:block; margin:120px;"></div>

<!-- ‚Üí üìäüí° Data-Driven Insights -->

<div style="text-align:center; font-size:2.5rem; font-weight:bold;">
üìäüí° Data-Driven Insights
</div>



:::
::::

- **Data storytelling** bridges the gap between **data** and **insight** by integrating **descriptive statistics**, **data transformation**, **visualization**, and **narration** within the appropriate **audience context** to communicate findings effectively and support **data-informed decision-making**.


## Data Storytelling - Visualization


:::: {.columns}

::: {.column width="55%"}
<div style="text-align: center; width: 100%; margin: auto;">
  <img src="https://bcdanl.github.io/lec_figs/data-storytelling-visual.png" style="width: 60%; margin-bottom: -20px;">
  <p style="font-weight: bold;"></p>
</div>
:::
::: {.column width="45%"}

- **Data Visualization**: Convert data into meaningful graphics for better understanding of data.

- There are many different graphs and other types of visual displays of information.

:::
::::



<div style="text-align:center">

<span class="fragment"> We will visualize: </span>

</div>

:::: {.columns}

::: {.column width="50%"}

  - The **distribution** of a categorical variable
  - The **distribution** of a numeric variable
  
:::
::: {.column width="50%"}

  - The **relationship** between two numeric variables
  - The **time trend** of a numeric variable


:::
::::



# **Distribution** {background-color="#1c4982"}


## Distribution and Variation

:::: {.columns}

::: {.column width="50%"}
### Distribution

- **Distribution** describes **how the values of a variable are spread or grouped** within a dataset (`data.frame`).  
  - It reveals the **overall pattern** of how observations differ or cluster.  
  - Understanding distribution helps us see **where data are concentrated** and **where they are sparse**.
  
:::

::: {.column width="50%"}
### Variation

- **Variation** is the **tendency of a variable‚Äôs values to differ** from one measurement to another.  
  - In everyday life, we observe variation everywhere ‚Äî measuring the same numeric variable twice often gives slightly different results.  
  - Recognizing variation helps us understand **change** and **spread** in data.
  
:::
::::

<div style="display:block; margin:-30px;"></div>

<span class="fragment">
‚ú® Together, **distribution** and **variation** form the foundation of data analysis.
</span>



## üîç Key Questions When Analyzing Distribution

- **Which values are most common, and why?**
  <!-- <span class="fragment">‚Üí The **mode** is the value that appears most frequently in the dataset.</span> -->

- **Which values are rare, and why?**  
  <span class="fragment">‚Üí Does this pattern align with your expectations, or reveal something surprising?</span>

- **How wide is the spread?**  
  <span class="fragment">‚Üí Are the values tightly clustered or widely dispersed? (e.g., **range**, **IQR**, **standard deviation**)</span>

- **Are there any outliers?**  
  <span class="fragment">‚Üí What causes them ‚Äî data errors, unusual events, or genuine variation?</span>

- **What is the shape of the distribution?**  
  <span class="fragment">‚Üí Is it **symmetric**, **skewed**, **unimodal**, or **bimodal**?</span>

- **Are there patterns or subgroups?**  
  <span class="fragment">‚Üí Do certain categories or conditions show different distributions?</span>


## Distribution
- How you visualize the distribution of a variable depends on the type of variable: **categorical** or **numerical**.


:::: {.columns}

::: {.column width="50%"}
- **Categorical Variables**: Represent categories or groups (e.g., colors, departments, types)
  - Common visualizations:\
  **Bar charts**
  - <u>Example</u>: Distribution of favorite sports among students

:::
::: {.column width="50%"}  
- **Numerical Variables**: Represent numbers with meaningful values (e.g., age, income, temperature)
  - Common visualizations: **Histograms**, **Box plots**
  - <u>Example</u>: Distribution of heights in a class

:::
::::



## Titanic Data

```{r}
#| results: asis
DT::datatable(titanic, options = list(
  pageLength = 5
))
```


## Bar Chart

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_bar(mapping = 
               aes(x = survived, fill = survived ),
           show.legend = F) +
  labs(x = "Survival Status",
       y = "Number of\n People",
       title = "How is the distribution of survival status in Titanic?")
```



## Horizontal Bar Chart

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_bar(mapping = 
               aes(y = survived, fill = survived ),
           show.legend = F) +
  labs(y = "Survival Status",
       x = "Number of\n People",
       title = "How is the distribution of survival status in Titanic?") 
```



## Stacked Bar Chart

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_bar(mapping = 
               aes(y = class, fill = survived ) ) +
  labs(y = "Ticket\n Class",
       x = "Number of\n People",
       fill = "Survival Status",
       title = "How does the distribution of survival status varies by ticket class\n in Titanic?") 
```



## 100% Stacked Bar Chart

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_bar(mapping = 
               aes(y = class, fill = survived ),
           position = "fill") +
  labs(y = "Ticket\n Class",
       x = "Proportion of\n People",
       fill = "Survival Status",
       title = "How does the distribution of survival status varies by ticket class\n in Titanic?") 
```



## Clustered Bar Chart

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_bar(mapping = 
               aes(y = class, fill = survived ),
           position = "dodge") +
  labs(y = "Ticket\n Class",
       x = "Number of\n People",
       fill = "Survival Status",
       title = "How does the distribution of survival status varies by ticket class\n in Titanic?") 

```




## Histogram

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_histogram(mapping = 
               aes(x = age ),
               color = 'black',
               fill = 'lightblue'
               ) +
  labs(y = "Number of\n People",
       x = "Age",
       title = "How is the distribution of age in Titanic?")
```



## Histogram

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_histogram(mapping = 
               aes(x = age, fill = survived ),
               show.legend = F) +
  facet_grid(.~survived) +
  labs(y = "Number of\n People",
       x = "Age",
       title = "How does the distribution of age varies by survival status\n in Titanic?") 
```


## ‚öñÔ∏è Skewness

:::{.nonincremental}
- In a **distribution**, **skewness** describes the **asymmetry** of a distribution.  
  - It shows whether the data are **stretched more to the left or right** of the center.
:::


<div style="text-align: center; width: 100%; margin: auto;">
  <img src="https://bcdanl.github.io/lec_figs/skewness.jpg" style="width: 75%; margin-bottom: -20px;">
  <p style="font-weight: bold;"></p>
</div>







## üèîÔ∏è Modality

:::{.nonincremental}

- How many peaks does the distribution have?  
  - Is it **unimodal** (one peak) or **bimodal** (two peaks)?  
  - Or perhaps **uniform** or **multimodal**?

:::

```{r}
#| fig-align: center
set.seed(42)

# --- Simulate data for each modality ---
n <- 3000

unimodal   <- tibble::tibble(value = rnorm(n, mean = 0,  sd = 1),  modality = "unimodal")
bimodal    <- tibble::tibble(value = c(rnorm(n/2, -2, 1), rnorm(n/2, 2, 1)), modality = "bimodal")
uniform    <- tibble::tibble(value = runif(n, min = -3, max = 3), modality = "uniform")
multimodal <- tibble::tibble(
  value = c(rnorm(n/3, -3, 0.6), rnorm(n/3, 0, 0.4), rnorm(n/3, 3, 0.8)),
  modality = "multimodal"
)

df <- bind_rows(unimodal, bimodal, uniform, multimodal) |> 
  mutate(modality = factor(modality,
                           levels = 
                             c("unimodal", "bimodal", "multimodal", "uniform")))

# --- Plot: histogram + density overlay, faceted by modality ---
ggplot(df, aes(x = value)) +
  geom_histogram(aes(y = after_stat(density)),
                 bins = 20, fill = "#2C6DA4", color = "white") +
  geom_density(linewidth = 1.2, color = "#F28E2B", adjust = 1.0) +
  facet_wrap(~ modality, nrow = 1, scales = "free_x") +
  labs(title = NULL, x = NULL, y = NULL) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.minor = element_blank(),
    strip.text = element_text(face = "bold"),
    axis.text.y = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank()
  )
```



## Boxplot

```{r}
#| echo: false

ggplot(data = titanic) + 
  geom_boxplot(mapping = 
               aes(x = age, y = survived)
               ) +
  labs(y = "Survival Status",
       x = "Age",
       title = "How does the distribution of age varies by survival status\n in Titanic?") 
```


# **Relationship** {background-color="#1c4982"}

## üîó Relationship

- When examining plots with two numeric variables, we look for **co-variation** ‚Äî the tendency of two variables to **change together** in a related way.

- üîç <u>Key questions to ask</u>:
  - Are the variables **positively related** (as one increases, the other increases)?
  - Are they **negatively related** (as one increases, the other decreases)?
  - Or is there **no clear relationship** between them?

- Common visualizations:
  - **Scatterplot**
  - **Fitted line or curve** to reveal the pattern of association
  

<!-- ## Relationship -->
<!-- - From the plots with two numeric variables, we want to see **co-variation**, the tendency for the values of two or more variables to vary together in a **related** way.  -->

<!-- - What type of **co-variation** occurs between variables? -->
<!--   - Are they **positively** associated? -->
<!--   - Are they **negatively** associated? -->
<!--   - Are there **no association** between them? -->

<!-- - Common visualizations:  -->
<!--   - **Scatterplot** -->
<!--   - **Fitted curves/line** -->




## Orange Juice Sales

```{r}
#| results: asis
DT::datatable(oj, options = list(
  pageLength = 5
))
```
  

## Scatterplot
```{r}
#| echo: false

ggplot(data = oj) + 
  geom_point(mapping = 
               aes(x = log(sales), y = log(price) ),
             alpha = .05
               ) +
  labs(y = "Price (in log)",
       x = "Quantity (in log)",
       title = "How is the quantity of OJ sales is related to its price?") 
```



## Scatterplot with Fitted Line
```{r}
#| echo: false

ggplot(data = oj,
       mapping = 
               aes(x = log(sales), y = log(price) )
             ) + 
  geom_point(alpha = .05) +
  geom_smooth(method = lm) +
  labs(y = "Price (in log)",
       x = "Quantity (in log)",
       title = "How is the quantity of OJ sales is related to its price?") 
```




## Scatterplot with Fitted Line
```{r}
#| echo: false

ggplot(data = oj,
       mapping = 
               aes(x = log(sales), y = log(price),
                   color = brand)
             ) + 
  geom_point(alpha = .025) +
  geom_smooth(method = lm) +
  labs(y = "Price (in log)",
       x = "Quantity (in log)",
       title = "How does the relationship between OJ sales and its price\n varies by brand?")
```




## MPG Data

```{r}
#| results: asis
DT::datatable(mpg, options = list(
  pageLength = 5
))
```
  
  
## Scatterplot with Fitted Line
```{r}
#| echo: false

ggplot(data = mpg,
       mapping = 
               aes(x = cty, y = hwy)
             ) + 
  geom_point(alpha = .33) +
  geom_smooth(method = lm, se = F) +
  labs(y = "City MPG",
       x = "Highway MPG",
       title = "How is city MPG related to highway MPG?") 
```



## Weather Data

```{r}
#| results: asis
DT::datatable(weather_indep, options = list(
  pageLength = 5
))
```
  
  
## Scatterplot with Fitted Line
```{r}
#| echo: false

ggplot(data = weather_indep,
       mapping = 
               aes(x = rainfall, y = temperature)
             ) + 
  geom_point() +
  geom_smooth(method = lm, se = F) +
  labs(y = "Temperature",
       x = "Rainfall",
       title = "How is rainfall related to temperature?") 
```



## ‚öôÔ∏è Input vs. Outcome: Plotting Relationships

- **Be mindful of how you place variables on the axes.**  
  - It‚Äôs standard practice to put the **input variable** on the **x-axis** and the **outcome variable** on the **y-axis**.

- **Input Variable** ‚Üí represents the potential **cause** or influencing factor.  
- **Outcome Variable** ‚Üí represents the potential **effect** or result.

  - **Example:** Advertising budget (**input**) vs. sales revenue (**outcome**)
  
  

## Correlation Does Not Imply Causation

<div style="text-align: center; width: 100%; margin: auto;">
  <img src="https://bcdanl.github.io/lec_figs/corr-causal.png" style="width: 50%; margin-bottom: -20px;">
  <p style="font-weight: bold;"></p>
</div>

- Just because you uncover a relationship doesn't mean you've identified the "causal" relationship.
  <!-- - **Causal inference** is the study of identifying cause-and-effect relationships from data, beyond simple correlations. -->




<!-- ## Correlation Does Not Imply Causation -->

<!-- - **Caution**: Correlation does not imply causation -->
<!--   - A strong correlation does not imply that one variable causes the other to change. -->

<!-- - **Correlation** measures the **strength and direction** of a linear relationship between two variables. -->
<!--   - Positive/negative correlation -->
<!--   - Strong/weak correlation -->
<!--   - No correlation -->

<!-- - **Causation**: Indicates that one variable directly influences or causes a change in another -->
<!--   - Establishing causation requires controlled experimentation or additional evidence -->
<!--   - E.g., Smoking causes an increase in lung cancer risk (causation) -->

## ‚ö†Ô∏è Correlation ‚â† Causation

- **Caution:** A strong correlation between two variables **does not mean** that one causes the other to change.  
  - Two variables can move together **by coincidence** or due to a **third, unseen factor**.

- **Correlation** describes the **strength** and **direction** of a **linear relationship** between two variables:  
  - **Positive / Negative** ‚Üí direction of relationship  
  - **Strong / Weak** ‚Üí how **clear** (or **uncertain**) the relationship is
  - **Slope** ‚Üí the **rate of change** in the outcome per unit of input
  
- **Causation** means that one variable **directly affects** another.  
  - Demonstrating causation requires **controlled experiments** or **supporting evidence** beyond correlation.  
  - <u>*e.g.,*</u>: Smoking **causes** an increase in lung cancer risk (causation).
  


# **Time Trend** {background-color="#1c4982"}

## ‚è∞ Time Trend

- A **time trend** (or **time series**) plot shows how a variable **changes over time**, revealing **trends**, **patterns**, and **fluctuations**.  
  - The **x-axis** represents **time**, and the **y-axis** represents the **measured variable**.

- It helps us observe the overall **direction of change** ‚Äî whether the variable is **increasing**, **decreasing**, or **remaining relatively stable** over time.

- Common visualizations:
  - **Line chart**
  - **Fitted curve** to smooth short-term fluctuations
  
<!-- ## Time Trend -->

<!-- - A **time trend** plot, (also known as a *time series* plot), is used to visualize trends, patterns, and fluctuations in a variable over a specific time period.  -->
<!--   - The x-axis typically represents time, while the y-axis represents the variable being measured.  -->

<!-- - We can check the overall direction in which the time-series variable are **moving‚Äîupwards**, **downwards**, or **staying relatively constant** over time. -->

<!-- - Common visualizations:  -->
<!--   - **Line Chart** -->
<!--   - **Fitted Curve** -->
  


## NVDA Stock Price Data

```{r}
#| results: asis
DT::datatable(nvda |> select(Date, Close), options = list(
  pageLength = 5
))
```
  
  
## Line Chart

```{r}
#| echo: false
ggplot(data = nvda,
       mapping = 
                aes(x = Date, 
                    y = Close)) + 
  geom_line() +
  geom_point(size = .1) +
  labs(x = "Date",
       y = "Price",
       title = "How is the daily trend of Nvidia's stock price since 2015?")
```


  
## Line Chart with Fitted Curve

```{r}
#| echo: false
ggplot(data = nvda,
       mapping = 
                aes(x = Date, 
                    y = Close)) + 
  geom_line() +
  geom_smooth() +
  geom_point(size = .1) +
  labs(x = "Date",
       y = "Price",
       title = "How is the daily trend of Nvidia's stock price since 2015?")
```





<!-- ## Visualization Tools -->

<!-- - Many tools for visualizing data -- **Power BI**, **Tableau**, **Excel**, **Python**, **R**, and more -->

<!-- - **Power BI** and **Tableau** have **drag-and-drop interfaces**, making them accessible to users with little to no coding experience. -->

<!-- - In **R**, there are multiple packages for creating data visualizations‚Äî**ggplot2** is the most widely used one. -->
<!--   - While we will briefly use **Power BI** and **Excel** for visualization, the primary visualization tool for this course will be **ggplot2** in **R**. -->

<!-- - Using **ggplot2** helps develop important coding and data skills, which are critical for more advanced data analytics work. -->



